<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fantasy Draft Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f8f9fa;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .navbar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .navbar-brand {
        font-weight: bold;
        font-size: 1.5rem;
      }

      .tab-content {
        padding: 20px 0;
      }

      .table {
        background: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .table thead th {
        background: #343a40;
        color: white;
        border: none;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 0.5px;
      }

      .table tbody tr {
        transition: all 0.2s ease;
      }

      .table tbody tr:hover {
        background-color: #f8f9fa;
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      /* Tier-based row coloring */
      .tier-1 {
        background-color: #e8f5e8 !important;
      }
      .tier-2 {
        background-color: #f0f8ff !important;
      }
      .tier-3 {
        background-color: #fff8e1 !important;
      }
      .tier-4 {
        background-color: #ffebee !important;
      }
      .tier-5 {
        background-color: #f3e5f5 !important;
      }

      /* Value pick highlighting */
      .value-steal {
        background: linear-gradient(135deg, #4caf50, #66bb6a) !important;
        color: white !important;
      }

      .value-good {
        background: linear-gradient(135deg, #8bc34a, #9ccc65) !important;
        color: white !important;
      }

      .value-reach {
        background: linear-gradient(135deg, #f44336, #e57373) !important;
        color: white !important;
      }

      /* Drafted player styling */
      .drafted {
        text-decoration: line-through;
        opacity: 0.6;
        background-color: #e9ecef !important;
      }

      .drafted-checkbox {
        cursor: pointer;
        width: 20px;
        height: 20px;
      }

      .position-badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
        text-transform: uppercase;
      }

      .qb-badge {
        background-color: #2196f3;
        color: white;
      }
      .rb-badge {
        background-color: #4caf50;
        color: white;
      }
      .wr-badge {
        background-color: #ff9800;
        color: white;
      }
      .te-badge {
        background-color: #9c27b0;
        color: white;
      }

      .scarcity-cliff {
        background-color: #ffebee !important;
        border-left: 4px solid #f44336;
      }

      .scarcity-drop {
        background-color: #fff3e0 !important;
        border-left: 4px solid #ff9800;
      }

      .stats-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .stats-card h4 {
        color: #495057;
        margin-bottom: 15px;
        font-weight: 600;
      }

      .search-container {
        margin-bottom: 20px;
      }

      .search-input {
        border-radius: 25px;
        border: 2px solid #e9ecef;
        padding: 10px 20px;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      .search-input:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
      }

      .draft-controls {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .draft-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 25px;
        padding: 10px 20px;
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .draft-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      }

      .draft-button:disabled {
        background: #6c757d;
        transform: none;
        box-shadow: none;
      }

      .round-indicator {
        background: #667eea;
        color: white;
        padding: 5px 10px;
        border-radius: 15px;
        font-weight: bold;
        margin-left: 10px;
      }

      @media (max-width: 768px) {
        .table-responsive {
          font-size: 0.8rem;
        }

        .navbar-brand {
          font-size: 1.2rem;
        }
      }

      /* Analytics-specific styles */
      .analytics-summary-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .analytics-summary-card h5 {
        margin-bottom: 10px;
        font-weight: 600;
      }

      .analytics-summary-card .count {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .analytics-filters {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .analytics-table th {
        background: #495057 !important;
        color: white !important;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .analytics-table td {
        vertical-align: middle;
        font-size: 0.85rem;
      }

      .badge {
        font-size: 0.75rem;
        padding: 4px 8px;
      }

      .table-danger {
        background-color: #f8d7da !important;
      }

      .table-warning {
        background-color: #fff3cd !important;
      }

      .analytics-help {
        background: #e7f3ff;
        border: 1px solid #b3d9ff;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
      }

      .analytics-help h6 {
        color: #0066cc;
        margin-bottom: 10px;
      }

      .analytics-help ul {
        margin-bottom: 0;
        padding-left: 20px;
      }

      .analytics-help li {
        margin-bottom: 5px;
        color: #495057;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="#">
          <i class="fas fa-football-ball me-2"></i>
          Fantasy Draft Dashboard
        </a>
        <div class="d-flex align-items-center">
          <span class="round-indicator" id="currentRound">Round 1, Pick 1</span>
          <button class="btn btn-outline-light ms-3" onclick="resetDraft()">
            <i class="fas fa-undo me-1"></i> Reset Draft
          </button>
        </div>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <!-- Tab Navigation -->
      <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="overall-tab"
            data-bs-toggle="tab"
            data-bs-target="#overall"
            type="button"
            role="tab"
          >
            <i class="fas fa-trophy me-1"></i> Overall
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="qb-tab"
            data-bs-toggle="tab"
            data-bs-target="#qb"
            type="button"
            role="tab"
          >
            <i class="fas fa-user-astronaut me-1"></i> QB
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="rb-tab"
            data-bs-toggle="tab"
            data-bs-target="#rb"
            type="button"
            role="tab"
          >
            <i class="fas fa-running me-1"></i> RB
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="wr-tab"
            data-bs-toggle="tab"
            data-bs-target="#wr"
            type="button"
            role="tab"
          >
            <i class="fas fa-bolt me-1"></i> WR
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="te-tab"
            data-bs-toggle="tab"
            data-bs-target="#te"
            type="button"
            role="tab"
          >
            <i class="fas fa-hands me-1"></i> TE
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="draft-board-tab"
            data-bs-toggle="tab"
            data-bs-target="#draft-board"
            type="button"
            role="tab"
          >
            <i class="fas fa-clipboard-list me-1"></i> Draft Board
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="config-tab"
            data-bs-toggle="tab"
            data-bs-target="#config"
            type="button"
            role="tab"
          >
            <i class="fas fa-cog me-1"></i> Settings
          </button>
        </li>
      </ul>

      <!-- Tab Content -->
      <div class="tab-content" id="dashboardTabContent">
        <!-- Overall Tab -->
        <div class="tab-pane fade show active" id="overall" role="tabpanel">
          <div class="alert alert-info py-2 mb-3">
            <small
              ><i class="fas fa-info-circle me-1"></i>
              <strong>Quick Draft:</strong> Check players to draft them. Pick
              numbers auto-increment (1 to number of teams per round). Press
              <kbd>Space</kbd> on a row to quickly toggle draft status.</small
            >
          </div>
          <div class="row">
            <div class="col-md-8">
              <div class="search-container">
                <input
                  type="text"
                  class="form-control search-input"
                  id="overallSearch"
                  placeholder="Search players..."
                />
              </div>
            </div>
            <div class="col-md-4">
              <div class="draft-controls">
                <div class="row">
                  <div class="col-6">
                    <input
                      type="number"
                      class="form-control"
                      id="draftRound"
                      placeholder="Round"
                      min="1"
                      max="20"
                    />
                  </div>
                  <div class="col-6">
                    <input
                      type="number"
                      class="form-control"
                      id="draftPick"
                      placeholder="Pick"
                      min="1"
                      max="12"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="overallTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Rank</th>
                  <th>Player</th>
                  <th>Pos</th>
                  <th>Team</th>
                  <th>Points</th>
                  <th>VORP</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <th>ADP Diff</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody id="overallBody">
                <!-- Data will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Position Tabs -->
        <div class="tab-pane fade" id="qb" role="tabpanel">
          <div class="search-container">
            <input
              type="text"
              class="form-control search-input"
              id="qbSearch"
              placeholder="Search QB..."
            />
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="qbTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Pos Rank</th>
                  <th>Player</th>
                  <th>Team</th>
                  <th>Points</th>
                  <th>VORP</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <!-- <th>Scarcity</th> -->
                </tr>
              </thead>
              <tbody id="qbBody"></tbody>
            </table>
          </div>
        </div>

        <div class="tab-pane fade" id="rb" role="tabpanel">
          <div class="search-container">
            <input
              type="text"
              class="form-control search-input"
              id="rbSearch"
              placeholder="Search RB..."
            />
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="rbTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Pos Rank</th>
                  <th>Player</th>
                  <th>Team</th>
                  <th>Points</th>
                  <th>VORP</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <!-- <th>Scarcity</th> -->
                </tr>
              </thead>
              <tbody id="rbBody"></tbody>
            </table>
          </div>
        </div>

        <div class="tab-pane fade" id="wr" role="tabpanel">
          <div class="search-container">
            <input
              type="text"
              class="form-control search-input"
              id="wrSearch"
              placeholder="Search WR..."
            />
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="wrTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Pos Rank</th>
                  <th>Player</th>
                  <th>Team</th>
                  <th>Points</th>
                  <th>VORP</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <!-- <th>Scarcity</th> -->
                </tr>
              </thead>
              <tbody id="wrBody"></tbody>
            </table>
          </div>
        </div>

        <div class="tab-pane fade" id="te" role="tabpanel">
          <div class="search-container">
            <input
              type="text"
              class="form-control search-input"
              id="teSearch"
              placeholder="Search TE..."
            />
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="teTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Pos Rank</th>
                  <th>Player</th>
                  <th>Team</th>
                  <th>Points</th>
                  <th>VORP</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <!-- <th>Scarcity</th> -->
                </tr>
              </thead>
              <tbody id="teBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Draft Board Tab -->
        <div class="tab-pane fade" id="draft-board" role="tabpanel">
          <div class="search-container">
            <input
              type="text"
              class="form-control search-input"
              id="draftBoardSearch"
              placeholder="Search draft board..."
            />
          </div>
          <div class="table-responsive">
            <table class="table table-striped" id="draftBoardTable">
              <thead>
                <tr>
                  <th>Drafted</th>
                  <th>Priority</th>
                  <th>Rank</th>
                  <th>Player</th>
                  <th>Pos</th>
                  <th>Team</th>
                  <th>Tier</th>
                  <th>ADP</th>
                  <th>Value</th>
                  <th>Round</th>
                  <th>Pick</th>
                </tr>
              </thead>
              <tbody id="draftBoardBody"></tbody>
            </table>
          </div>
        </div>

        <!-- Configuration Tab -->
        <div class="tab-pane fade" id="config" role="tabpanel">
          <!-- Top Save Buttons -->
          <div class="row mb-4">
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <h6 class="mb-0">Quick Save</h6>
                      <small class="text-muted"
                        >Save your changes without scrolling</small
                      >
                    </div>
                    <div>
                      <button
                        class="btn btn-primary me-2"
                        onclick="saveConfig()"
                      >
                        <i class="fas fa-save me-1"></i> Save Settings
                      </button>
                      <button
                        class="btn btn-secondary me-2"
                        onclick="loadConfig()"
                      >
                        <i class="fas fa-sync me-1"></i> Load Current
                      </button>
                      <button class="btn btn-warning" onclick="resetConfig()">
                        <i class="fas fa-undo me-1"></i> Reset to Default
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title mb-0">
                    <i class="fas fa-users me-2"></i>League Settings
                  </h5>
                </div>
                <div class="card-body">
                  <div class="row mb-3">
                    <div class="col-6">
                      <label for="numTeams" class="form-label"
                        >Number of Teams</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="numTeams"
                        min="8"
                        max="20"
                        value="12"
                      />
                    </div>
                    <div class="col-6">
                      <label for="superflex" class="form-label"
                        >Superflex</label
                      >
                      <select class="form-control" id="superflex">
                        <option value="true">Yes</option>
                        <option value="false">No</option>
                      </select>
                    </div>
                  </div>
                  <h6>Starting Lineup</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="qbStarters" class="form-label">QB</label>
                      <input
                        type="number"
                        class="form-control"
                        id="qbStarters"
                        min="1"
                        max="2"
                        value="1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="rbStarters" class="form-label">RB</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rbStarters"
                        min="1"
                        max="3"
                        value="2"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="wrStarters" class="form-label">WR</label>
                      <input
                        type="number"
                        class="form-control"
                        id="wrStarters"
                        min="1"
                        max="3"
                        value="2"
                      />
                    </div>
                    <div class="col-6">
                      <label for="teStarters" class="form-label">TE</label>
                      <input
                        type="number"
                        class="form-control"
                        id="teStarters"
                        min="1"
                        max="2"
                        value="1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="flexStarters" class="form-label">FLEX</label>
                      <input
                        type="number"
                        class="form-control"
                        id="flexStarters"
                        min="0"
                        max="2"
                        value="1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="superflexStarters" class="form-label"
                        >SUPERFLEX</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="superflexStarters"
                        min="0"
                        max="2"
                        value="1"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title mb-0">
                    <i class="fas fa-calculator me-2"></i>Scoring Settings
                  </h5>
                </div>
                <div class="card-body">
                  <h6>Passing</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="passYd" class="form-label">Pass Yds</label>
                      <input
                        type="number"
                        class="form-control"
                        id="passYd"
                        step="0.01"
                        value="0.04"
                      />
                    </div>
                    <div class="col-6">
                      <label for="passTd" class="form-label">Pass TD</label>
                      <input
                        type="number"
                        class="form-control"
                        id="passTd"
                        step="0.5"
                        value="4"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="passInt" class="form-label"
                        >Interception</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="passInt"
                        step="0.5"
                        value="-2"
                      />
                    </div>
                    <div class="col-6">
                      <label for="pass2pt" class="form-label">Pass 2PT</label>
                      <input
                        type="number"
                        class="form-control"
                        id="pass2pt"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Rushing</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="rushYd" class="form-label">Rush Yds</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rushYd"
                        step="0.01"
                        value="0.1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="rushTd" class="form-label">Rush TD</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rushTd"
                        step="0.5"
                        value="6"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="rush2pt" class="form-label">Rush 2PT</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rush2pt"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Receiving</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="rec" class="form-label">Reception</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rec"
                        step="0.5"
                        value="1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="recYd" class="form-label">Rec Yds</label>
                      <input
                        type="number"
                        class="form-control"
                        id="recYd"
                        step="0.01"
                        value="0.1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="recTd" class="form-label">Rec TD</label>
                      <input
                        type="number"
                        class="form-control"
                        id="recTd"
                        step="0.5"
                        value="6"
                      />
                    </div>
                    <div class="col-6">
                      <label for="rec2pt" class="form-label">Rec 2PT</label>
                      <input
                        type="number"
                        class="form-control"
                        id="rec2pt"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Kicking</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="fg_0_19" class="form-label">FG 0-19</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_0_19"
                        step="0.5"
                        value="3"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fg_20_29" class="form-label">FG 20-29</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_20_29"
                        step="0.5"
                        value="3"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="fg_30_39" class="form-label">FG 30-39</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_30_39"
                        step="0.5"
                        value="3"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fg_40_49" class="form-label">FG 40-49</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_40_49"
                        step="0.5"
                        value="4"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="fg_50_59" class="form-label">FG 50-59</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_50_59"
                        step="0.5"
                        value="5"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fg_60_plus" class="form-label">FG 60+</label>
                      <input
                        type="number"
                        class="form-control"
                        id="fg_60_plus"
                        step="0.5"
                        value="6"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="pat_made" class="form-label">PAT Made</label>
                      <input
                        type="number"
                        class="form-control"
                        id="pat_made"
                        step="0.5"
                        value="1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fg_missed" class="form-label"
                        >FG Missed</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="fg_missed"
                        step="0.5"
                        value="-1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="pat_missed" class="form-label"
                        >PAT Missed</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pat_missed"
                        step="0.5"
                        value="-1"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Team Defense</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="def_td" class="form-label">Defense TD</label>
                      <input
                        type="number"
                        class="form-control"
                        id="def_td"
                        step="0.5"
                        value="6"
                      />
                    </div>
                    <div class="col-6">
                      <label for="pts_allowed_0" class="form-label"
                        >Pts Allowed 0</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_0"
                        step="0.5"
                        value="5"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="pts_allowed_1_6" class="form-label"
                        >Pts Allowed 1-6</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_1_6"
                        step="0.5"
                        value="4"
                      />
                    </div>
                    <div class="col-6">
                      <label for="pts_allowed_7_13" class="form-label"
                        >Pts Allowed 7-13</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_7_13"
                        step="0.5"
                        value="3"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="pts_allowed_14_20" class="form-label"
                        >Pts Allowed 14-20</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_14_20"
                        step="0.5"
                        value="1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="pts_allowed_28_34" class="form-label"
                        >Pts Allowed 28-34</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_28_34"
                        step="0.5"
                        value="-1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="pts_allowed_35_plus" class="form-label"
                        >Pts Allowed 35+</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="pts_allowed_35_plus"
                        step="0.5"
                        value="-4"
                      />
                    </div>
                    <div class="col-6">
                      <label for="yds_allowed_lt_100" class="form-label"
                        >Yds <100</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_lt_100"
                        step="0.5"
                        value="5"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="yds_allowed_100_199" class="form-label"
                        >Yds 100-199</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_100_199"
                        step="0.5"
                        value="3"
                      />
                    </div>
                    <div class="col-6">
                      <label for="yds_allowed_200_299" class="form-label"
                        >Yds 200-299</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_200_299"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="yds_allowed_350_399" class="form-label"
                        >Yds 350-399</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_350_399"
                        step="0.5"
                        value="-1"
                      />
                    </div>
                    <div class="col-6">
                      <label for="yds_allowed_400_449" class="form-label"
                        >Yds 400-449</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_400_449"
                        step="0.5"
                        value="-3"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="yds_allowed_450_499" class="form-label"
                        >Yds 450-499</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_450_499"
                        step="0.5"
                        value="-5"
                      />
                    </div>
                    <div class="col-6">
                      <label for="yds_allowed_500_549" class="form-label"
                        >Yds 500-549</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_500_549"
                        step="0.5"
                        value="-6"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="yds_allowed_550_plus" class="form-label"
                        >Yds 550+</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="yds_allowed_550_plus"
                        step="0.5"
                        value="-7"
                      />
                    </div>
                    <div class="col-6">
                      <label for="sack" class="form-label">Sack</label>
                      <input
                        type="number"
                        class="form-control"
                        id="sack"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="interception" class="form-label"
                        >Interception</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="interception"
                        step="0.5"
                        value="2"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fum_rec" class="form-label"
                        >Fumble Recovery</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="fum_rec"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="safety" class="form-label">Safety</label>
                      <input
                        type="number"
                        class="form-control"
                        id="safety"
                        step="0.5"
                        value="2"
                      />
                    </div>
                    <div class="col-6">
                      <label for="forced_fum" class="form-label"
                        >Forced Fumble</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="forced_fum"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="blocked_kick" class="form-label"
                        >Blocked Kick</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="blocked_kick"
                        step="0.5"
                        value="2"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Special Teams Defense</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="st_def_td" class="form-label"
                        >ST Def TD</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_def_td"
                        step="0.5"
                        value="6"
                      />
                    </div>
                    <div class="col-6">
                      <label for="st_def_forced_fum" class="form-label"
                        >ST Def Forced Fum</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_def_forced_fum"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="st_def_fum_rec" class="form-label"
                        >ST Def Fum Rec</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_def_fum_rec"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Special Teams Player</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="st_player_td" class="form-label"
                        >ST Player TD</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_player_td"
                        step="0.5"
                        value="6"
                      />
                    </div>
                    <div class="col-6">
                      <label for="st_player_forced_fum" class="form-label"
                        >ST Player Forced Fum</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_player_forced_fum"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-6">
                      <label for="st_player_fum_rec" class="form-label"
                        >ST Player Fum Rec</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="st_player_fum_rec"
                        step="0.5"
                        value="1"
                      />
                    </div>
                  </div>

                  <h6 class="mt-3">Misc</h6>
                  <div class="row">
                    <div class="col-6">
                      <label for="fum_lost" class="form-label"
                        >Fumble Lost</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="fum_lost"
                        step="0.5"
                        value="-2"
                      />
                    </div>
                    <div class="col-6">
                      <label for="fum_rec_td" class="form-label"
                        >Fumble Rec TD</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="fum_rec_td"
                        step="0.5"
                        value="6"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <h6 class="mb-0">Configuration Actions</h6>
                      <small class="text-muted"
                        >Save changes or reset to defaults</small
                      >
                    </div>
                    <div>
                      <button
                        class="btn btn-primary me-2"
                        onclick="saveConfig()"
                      >
                        <i class="fas fa-save me-1"></i> Save Settings
                      </button>
                      <button
                        class="btn btn-secondary me-2"
                        onclick="loadConfig()"
                      >
                        <i class="fas fa-sync me-1"></i> Load Current
                      </button>
                      <button class="btn btn-warning" onclick="resetConfig()">
                        <i class="fas fa-undo me-1"></i> Reset to Default
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script>
      let overallData = [];
      let positionData = { QB: [], RB: [], WR: [], TE: [] };
      let draftBoardData = [];
      let currentRound = 1;
      let currentPick = 1;
      let leagueConfig = { num_teams: 12 }; // Default to 12, will be updated from config

      // Load data on page load
      document.addEventListener("DOMContentLoaded", function () {
        loadOverallData();
        loadPositionData();
        loadDraftBoardData();
        setupSearch();
        loadConfig();
      });

      function loadOverallData() {
        fetch("/api/overall")
          .then((response) => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          })
          .then((data) => {
            overallData = data;
            renderOverallTable(data);
          })
          .catch((error) => {
            console.error("âŒ Error loading overall data:", error);
          });
      }

      function loadPositionData() {
        ["QB", "RB", "WR", "TE"].forEach((pos) => {
          fetch(`/api/position/${pos}`)
            .then((response) => {
              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
            })
            .then((data) => {
              positionData[pos] = data;
              renderPositionTable(pos, data);
            })
            .catch((error) => {
              console.error(`Error loading ${pos} data:`, error);
            });
        });
      }

      function loadDraftBoardData() {
        fetch("/api/draft_board")
          .then((response) => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          })
          .then((data) => {
            draftBoardData = data;
            renderDraftBoardTable(data);
          })
          .catch((error) =>
            console.error("Error loading draft board data:", error)
          );
      }

      function renderOverallTable(data) {
        const tbody = document.getElementById("overallBody");
        if (!tbody) {
          console.error("Overall table body element not found");
          return;
        }
        tbody.innerHTML = "";

        data.forEach((player) => {
          const row = createOverallRow(player);
          tbody.appendChild(row);
        });
      }

      function createOverallRow(player) {
        const row = document.createElement("tr");

        // Apply tier-based styling
        if (player.Tier) {
          row.classList.add(`tier-${player.Tier}`);
        }

        // Apply value-based styling
        if (player.Draft_Value === "STEAL") {
          row.classList.add("value-steal");
        } else if (player.Draft_Value === "VALUE") {
          row.classList.add("value-good");
        } else if (player.Draft_Value === "REACH") {
          row.classList.add("value-reach");
        }

        // Apply drafted styling
        if (player.drafted) {
          row.classList.add("drafted");
        }

        row.innerHTML = `
                <td><input type="checkbox" class="drafted-checkbox" ${
                  player.drafted ? "checked" : ""
                } data-player="${player.player.replace(
          /"/g,
          "&quot;"
        )}" onclick="handleCheckboxClick(this)"></td>
                <td>${player.Draft_Rank || player.Rank}</td>
                <td>${player.player}</td>
                <td><span class="position-badge ${player.position.toLowerCase()}-badge">${
          player.position
        }</span></td>
                <td>${player.team || ""}</td>
                <td>${player.points ? player.points.toFixed(1) : "0.0"}</td>
                <td>${player.VORP ? player.VORP.toFixed(1) : "0.0"}</td>
                <td>${player.Tier || ""}</td>
                <td>${
                  player.adp && player.adp !== 999 ? player.adp.toFixed(1) : "-"
                }</td>
                <td>${player.ADP_Diff ? player.ADP_Diff.toFixed(1) : "0.0"}</td>
                <td>${player.Draft_Value || ""}</td>
            `;

        return row;
      }

      function renderPositionTable(position, data) {
        const tbody = document.getElementById(`${position.toLowerCase()}Body`);
        if (!tbody) {
          console.error(
            `Table body element ${position.toLowerCase()}Body not found`
          );
          return;
        }
        tbody.innerHTML = "";

        data.forEach((player) => {
          const row = createPositionRow(player, position);
          tbody.appendChild(row);
        });
      }

      function createPositionRow(player, position) {
        const row = document.createElement("tr");

        // Apply tier-based styling
        if (player.Tier) {
          row.classList.add(`tier-${player.Tier}`);
        }

        // Apply scarcity styling
        // Scarcity field not implemented yet
        // if (player.Scarcity === "CLIFF") {
        //   row.classList.add("scarcity-cliff");
        // } else if (player.Scarcity === "DROP") {
        //   row.classList.add("scarcity-drop");
        // }

        // Apply drafted styling
        if (player.drafted) {
          row.classList.add("drafted");
        }

        row.innerHTML = `
                <td><input type="checkbox" class="drafted-checkbox" ${
                  player.drafted ? "checked" : ""
                } data-player="${player.player.replace(
          /"/g,
          "&quot;"
        )}" onclick="handleCheckboxClick(this)"></td>
                <td>${player.Pos_Rank || ""}</td>
                <td>${player.player || ""}</td>
                <td>${player.team || ""}</td>
                <td>${
                  player.points && typeof player.points === "number"
                    ? player.points.toFixed(1)
                    : "0.0"
                }</td>
                <td>${
                  player.VORP && typeof player.VORP === "number"
                    ? player.VORP.toFixed(1)
                    : "0.0"
                }</td>
                <td>${player.Tier || ""}</td>
                <td>${
                  player.adp &&
                  player.adp !== 999 &&
                  typeof player.adp === "number"
                    ? player.adp.toFixed(1)
                    : "-"
                }</td>
                <!-- <td>${player.Scarcity || ""}</td> -->
            `;

        return row;
      }

      function renderDraftBoardTable(data) {
        const tbody = document.getElementById("draftBoardBody");
        if (!tbody) {
          console.error("Draft board table body element not found");
          return;
        }
        tbody.innerHTML = "";

        data.forEach((player) => {
          const row = createDraftBoardRow(player);
          tbody.appendChild(row);
        });
      }

      function createDraftBoardRow(player) {
        const row = document.createElement("tr");

        // Apply tier-based styling
        if (player.Tier) {
          row.classList.add(`tier-${player.Tier}`);
        }

        // Apply value-based styling
        if (player.Value === "STEAL") {
          row.classList.add("value-steal");
        } else if (player.Value === "VALUE") {
          row.classList.add("value-good");
        } else if (player.Value === "REACH") {
          row.classList.add("value-reach");
        }

        // Apply drafted styling
        if (player.Drafted) {
          row.classList.add("drafted");
        }

        row.innerHTML = `
                <td><input type="checkbox" class="drafted-checkbox" ${
                  player.Drafted ? "checked" : ""
                } data-player="${player.Player.replace(
          /"/g,
          "&quot;"
        )}" onclick="handleCheckboxClick(this)"></td>
                <td>${
                  player.Priority !== undefined && player.Priority !== null
                    ? player.Priority.toFixed(2)
                    : "0.00"
                }</td>
                <td>${player.Rank || ""}</td>
                <td>${player.Player}</td>
                <td><span class="position-badge ${player.Pos.toLowerCase()}-badge">${
          player.Pos
        }</span></td>
                <td>${player.Team || ""}</td>
                <td>${player.Tier || ""}</td>
                <td>${
                  player.ADP && player.ADP !== 999 ? player.ADP.toFixed(1) : "-"
                }</td>
                <td>${player.Value || ""}</td>
                <td>${player.Round || ""}</td>
                <td>${player.Pick || ""}</td>
            `;

        return row;
      }

      function handleCheckboxClick(checkbox) {
        // Prevent rapid clicking
        if (checkbox.disabled) return;

        const playerName = checkbox.getAttribute("data-player");
        if (playerName) {
          // Temporarily disable checkbox to prevent double-clicks
          checkbox.disabled = true;
          setTimeout(() => (checkbox.disabled = false), 200);

          // Optimistic update - immediately update UI
          const row = checkbox.closest("tr");
          const wasChecked = checkbox.checked;

          // Update visual state immediately
          updateRowDraftedState(row, wasChecked);

          // Send update to server in background
          toggleDrafted(playerName, wasChecked);
        }
      }

      function updateRowDraftedState(row, isDrafted) {
        if (isDrafted) {
          row.classList.add("drafted");
        } else {
          row.classList.remove("drafted");
        }
      }

      function toggleDrafted(playerName, isDrafted) {
        let round =
          parseInt(document.getElementById("draftRound").value) || currentRound;
        let pick =
          parseInt(document.getElementById("draftPick").value) || currentPick;

        fetch("/api/update_drafted", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            player: playerName,
            drafted: isDrafted,
            round: round.toString(),
            pick: pick.toString(),
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              // Auto-increment pick and round for next draft
              if (isDrafted) {
                currentPick++;
                if (currentPick > leagueConfig.num_teams) {
                  // Assuming leagueConfig.num_teams team league
                  currentPick = 1;
                  currentRound++;
                }

                // Update UI
                document.getElementById("draftRound").value = currentRound;
                document.getElementById("draftPick").value = currentPick;
                document.getElementById(
                  "currentRound"
                ).textContent = `Round ${currentRound}, Pick ${currentPick} of ${leagueConfig.num_teams}`;
              }

              // Debounce table refreshes to reduce API calls
              clearTimeout(window.refreshTimeout);
              window.refreshTimeout = setTimeout(() => {
                refreshAllTables();
              }, 500); // Wait 500ms before refreshing to batch rapid updates
            } else {
              // If server update failed, revert the optimistic update
              console.error("Failed to update drafted status on server");
              // Revert the visual state
              const checkbox = document.querySelector(
                `[data-player="${playerName}"]`
              );
              if (checkbox) {
                const row = checkbox.closest("tr");
                checkbox.checked = !isDrafted;
                updateRowDraftedState(row, !isDrafted);
              }
            }
          })
          .catch((error) => {
            console.error("Error updating drafted status:", error);
            // Revert the visual state on error
            const checkbox = document.querySelector(
              `[data-player="${playerName}"]`
            );
            if (checkbox) {
              const row = checkbox.closest("tr");
              checkbox.checked = !isDrafted;
              updateRowDraftedState(row, !isDrafted);
            }
          });
      }

      function refreshAllTables() {
        loadOverallData();
        loadPositionData();
        loadDraftBoardData();
      }

      function setupSearch() {
        // Overall search
        const overallSearch = document.getElementById("overallSearch");
        if (overallSearch) {
          overallSearch.addEventListener("input", function (e) {
            filterTable("overallTable", e.target.value);
          });
        }

        // Add keyboard shortcuts for faster drafting
        let lastKeyPress = 0;
        document.addEventListener("keydown", function (e) {
          // Space bar to draft/undraft the currently focused row
          if (e.code === "Space") {
            e.preventDefault();

            // Prevent rapid key presses (debounce)
            const now = Date.now();
            if (now - lastKeyPress < 200) return;
            lastKeyPress = now;

            const activeElement = document.activeElement;
            if (activeElement && activeElement.closest("tr")) {
              const row = activeElement.closest("tr");
              const checkbox = row.querySelector(".drafted-checkbox");
              if (checkbox && !checkbox.disabled) {
                const wasChecked = checkbox.checked;
                checkbox.checked = !checkbox.checked;
                const playerName = checkbox.getAttribute("data-player");
                if (playerName) {
                  // Update visual state immediately
                  updateRowDraftedState(row, checkbox.checked);
                  // Send update to server
                  toggleDrafted(playerName, checkbox.checked);
                }
              }
            }
          }
        });
      }

      // Position searches
      ["qb", "rb", "wr", "te"].forEach((pos) => {
        const searchInput = document.getElementById(`${pos}Search`);
        if (searchInput) {
          searchInput.addEventListener("input", function (e) {
            filterTable(`${pos}Table`, e.target.value);
          });
        }
      });

      // Draft board search
      const draftBoardSearch = document.getElementById("draftBoardSearch");
      if (draftBoardSearch) {
        draftBoardSearch.addEventListener("input", function (e) {
          filterTable("draftBoardTable", e.target.value);
        });
      }
      function filterTable(tableId, searchTerm) {
        const table = document.getElementById(tableId);
        if (!table) {
          console.error(`Table element ${tableId} not found`);
          return;
        }

        const tbody = table.getElementsByTagName("tbody")[0];
        if (!tbody) {
          console.error(`Table body not found in ${tableId}`);
          return;
        }

        const rows = tbody.getElementsByTagName("tr");

        for (let i = 0; i < rows.length; i++) {
          const cells = rows[i].getElementsByTagName("td");
          let found = false;

          for (let j = 0; j < cells.length; j++) {
            if (
              cells[j].textContent
                .toLowerCase()
                .includes(searchTerm.toLowerCase())
            ) {
              found = true;
              break;
            }
          }

          rows[i].style.display = found ? "" : "none";
        }
      }

      function resetDraft() {
        if (
          confirm(
            "Are you sure you want to reset the draft? This will clear all drafted players."
          )
        ) {
          // Reset all drafted status
          fetch("/api/update_drafted", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              reset: true,
            }),
          })
            .then(() => {
              currentRound = 1;
              currentPick = 1;
              document.getElementById(
                "currentRound"
              ).textContent = `Round 1, Pick 1 of ${leagueConfig.num_teams}`;
              document.getElementById("draftRound").value = "";
              document.getElementById("draftPick").value = "";
              loadOverallData();
              loadPositionData();
              loadDraftBoardData();
            })
            .catch((error) => console.error("Error resetting draft:", error));
        }
      }

      // Configuration management functions (moved outside DOMContentLoaded for global access)
      function loadConfig() {
        fetch("/api/config")
          .then((response) => response.json())
          .then((config) => {
            // Store league config globally for use in other functions
            leagueConfig = config.league || { num_teams: 12 };

            // Load league settings
            document.getElementById("numTeams").value =
              leagueConfig.num_teams || 12;
            document.getElementById("draftPick").max =
              leagueConfig.num_teams || 12;
            document.getElementById("superflex").value = (
              leagueConfig.superflex || false
            ).toString();

            // Load starters
            const starters = leagueConfig.starters || {};
            document.getElementById("qbStarters").value = starters.QB || 1;
            document.getElementById("rbStarters").value = starters.RB || 2;
            document.getElementById("wrStarters").value = starters.WR || 2;
            document.getElementById("teStarters").value = starters.TE || 1;
            document.getElementById("flexStarters").value = starters.FLEX || 1;
            document.getElementById("superflexStarters").value =
              starters.SUPERFLEX !== undefined ? starters.SUPERFLEX : 1;

            // Load scoring settings
            const offense = config.scoring?.offense || {};
            document.getElementById("passYd").value = offense.pass_yd || 0.04;
            document.getElementById("passTd").value = offense.pass_td || 4;
            document.getElementById("passInt").value = offense.pass_int || -2;
            document.getElementById("pass2pt").value = offense.pass_2pt || 2;
            document.getElementById("rushYd").value = offense.rush_yd || 0.1;
            document.getElementById("rushTd").value = offense.rush_td || 6;
            document.getElementById("rush2pt").value = offense.rush_2pt || 2;
            document.getElementById("rec").value = offense.rec || 1;
            document.getElementById("recYd").value = offense.rec_yd || 0.1;
            document.getElementById("recTd").value = offense.rec_td || 6;
            document.getElementById("rec2pt").value = offense.rec_2pt || 2;

            const kicking = config.scoring?.kicking || {};
            document.getElementById("fg_0_19").value = kicking.fg_0_19 || 3;
            document.getElementById("fg_20_29").value = kicking.fg_20_29 || 3;
            document.getElementById("fg_30_39").value = kicking.fg_30_39 || 3;
            document.getElementById("fg_40_49").value = kicking.fg_40_49 || 4;
            document.getElementById("fg_50_59").value = kicking.fg_50_59 || 5;
            document.getElementById("fg_60_plus").value =
              kicking.fg_60_plus || 6;
            document.getElementById("pat_made").value = kicking.pat_made || 1;
            document.getElementById("fg_missed").value =
              kicking.fg_missed || -1;
            document.getElementById("pat_missed").value =
              kicking.pat_missed || -1;

            const defense = config.scoring?.defense || {};
            document.getElementById("def_td").value = defense.def_td || 6;
            document.getElementById("pts_allowed_0").value =
              defense.pts_allowed_0 || 5;
            document.getElementById("pts_allowed_1_6").value =
              defense.pts_allowed_1_6 || 4;
            document.getElementById("pts_allowed_7_13").value =
              defense.pts_allowed_7_13 || 3;
            document.getElementById("pts_allowed_14_20").value =
              defense.pts_allowed_14_20 || 1;
            document.getElementById("pts_allowed_28_34").value =
              defense.pts_allowed_28_34 || -1;
            document.getElementById("pts_allowed_35_plus").value =
              defense.pts_allowed_35_plus || -4;
            document.getElementById("yds_allowed_lt_100").value =
              defense.yds_allowed_lt_100 || 5;
            document.getElementById("yds_allowed_100_199").value =
              defense.yds_allowed_100_199 || 3;
            document.getElementById("yds_allowed_200_299").value =
              defense.yds_allowed_200_299 || 2;
            document.getElementById("yds_allowed_350_399").value =
              defense.yds_allowed_350_399 || -1;
            document.getElementById("yds_allowed_400_449").value =
              defense.yds_allowed_400_449 || -3;
            document.getElementById("yds_allowed_450_499").value =
              defense.yds_allowed_450_499 || -5;
            document.getElementById("yds_allowed_500_549").value =
              defense.yds_allowed_500_549 || -6;
            document.getElementById("yds_allowed_550_plus").value =
              defense.yds_allowed_550_plus || -7;
            document.getElementById("sack").value = defense.sack || 1;
            document.getElementById("interception").value =
              defense.interception || 2;
            document.getElementById("fum_rec").value = defense.fum_rec || 2;
            document.getElementById("safety").value = defense.safety || 2;
            document.getElementById("forced_fum").value =
              defense.forced_fum || 1;
            document.getElementById("blocked_kick").value =
              defense.blocked_kick || 2;

            const stDef = config.scoring?.special_teams_def || {};
            document.getElementById("st_def_td").value = stDef.st_def_td || 6;
            document.getElementById("st_def_forced_fum").value =
              stDef.st_def_forced_fum || 1;
            document.getElementById("st_def_fum_rec").value =
              stDef.st_def_fum_rec || 1;

            const stPlayer = config.scoring?.special_teams_player || {};
            document.getElementById("st_player_td").value =
              stPlayer.st_player_td || 6;
            document.getElementById("st_player_forced_fum").value =
              stPlayer.st_player_forced_fum || 1;
            document.getElementById("st_player_fum_rec").value =
              stPlayer.st_player_fum_rec || 1;

            const misc = config.scoring?.misc || {};
            document.getElementById("fum_lost").value = misc.fum_lost || -2;
            document.getElementById("fum_rec_td").value = misc.fum_rec_td || 6;

            console.log("Configuration loaded successfully!");
          })
          .catch((error) => {
            console.error("Error loading config:", error);
            alert("Error loading configuration");
          });
      }

      function saveConfig() {
        const config = {
          league: {
            num_teams: parseInt(document.getElementById("numTeams").value),
            superflex: document.getElementById("superflex").value === "true",
            starters: {
              QB: parseInt(document.getElementById("qbStarters").value),
              RB: parseInt(document.getElementById("rbStarters").value),
              WR: parseInt(document.getElementById("wrStarters").value),
              TE: parseInt(document.getElementById("teStarters").value),
              FLEX: parseInt(document.getElementById("flexStarters").value),
              SUPERFLEX: parseInt(
                document.getElementById("superflexStarters").value
              ),
            },
          },
          scoring: {
            offense: {
              pass_yd: parseFloat(document.getElementById("passYd").value),
              pass_td: parseFloat(document.getElementById("passTd").value),
              pass_int: parseFloat(document.getElementById("passInt").value),
              pass_2pt: parseFloat(document.getElementById("pass2pt").value),
              rush_yd: parseFloat(document.getElementById("rushYd").value),
              rush_td: parseFloat(document.getElementById("rushTd").value),
              rush_2pt: parseFloat(document.getElementById("rush2pt").value),
              rec: parseFloat(document.getElementById("rec").value),
              rec_yd: parseFloat(document.getElementById("recYd").value),
              rec_td: parseFloat(document.getElementById("recTd").value),
              rec_2pt: parseFloat(document.getElementById("rec2pt").value),
            },
            kicking: {
              fg_0_19: parseFloat(document.getElementById("fg_0_19").value),
              fg_20_29: parseFloat(document.getElementById("fg_20_29").value),
              fg_30_39: parseFloat(document.getElementById("fg_30_39").value),
              fg_40_49: parseFloat(document.getElementById("fg_40_49").value),
              fg_50_59: parseFloat(document.getElementById("fg_50_59").value),
              fg_60_plus: parseFloat(
                document.getElementById("fg_60_plus").value
              ),
              pat_made: parseFloat(document.getElementById("pat_made").value),
              fg_missed: parseFloat(document.getElementById("fg_missed").value),
              pat_missed: parseFloat(
                document.getElementById("pat_missed").value
              ),
            },
            defense: {
              def_td: parseFloat(document.getElementById("def_td").value),
              pts_allowed_0: parseFloat(
                document.getElementById("pts_allowed_0").value
              ),
              pts_allowed_1_6: parseFloat(
                document.getElementById("pts_allowed_1_6").value
              ),
              pts_allowed_7_13: parseFloat(
                document.getElementById("pts_allowed_7_13").value
              ),
              pts_allowed_14_20: parseFloat(
                document.getElementById("pts_allowed_14_20").value
              ),
              pts_allowed_28_34: parseFloat(
                document.getElementById("pts_allowed_28_34").value
              ),
              pts_allowed_35_plus: parseFloat(
                document.getElementById("pts_allowed_35_plus").value
              ),
              yds_allowed_lt_100: parseFloat(
                document.getElementById("yds_allowed_lt_100").value
              ),
              yds_allowed_100_199: parseFloat(
                document.getElementById("yds_allowed_100_199").value
              ),
              yds_allowed_200_299: parseFloat(
                document.getElementById("yds_allowed_200_299").value
              ),
              yds_allowed_350_399: parseFloat(
                document.getElementById("yds_allowed_350_399").value
              ),
              yds_allowed_400_449: parseFloat(
                document.getElementById("yds_allowed_400_449").value
              ),
              yds_allowed_450_499: parseFloat(
                document.getElementById("yds_allowed_450_499").value
              ),
              yds_allowed_500_549: parseFloat(
                document.getElementById("yds_allowed_500_549").value
              ),
              yds_allowed_550_plus: parseFloat(
                document.getElementById("yds_allowed_550_plus").value
              ),
              sack: parseFloat(document.getElementById("sack").value),
              interception: parseFloat(
                document.getElementById("interception").value
              ),
              fum_rec: parseFloat(document.getElementById("fum_rec").value),
              safety: parseFloat(document.getElementById("safety").value),
              forced_fum: parseFloat(
                document.getElementById("forced_fum").value
              ),
              blocked_kick: parseFloat(
                document.getElementById("blocked_kick").value
              ),
            },
            special_teams_def: {
              st_def_td: parseFloat(document.getElementById("st_def_td").value),
              st_def_forced_fum: parseFloat(
                document.getElementById("st_def_forced_fum").value
              ),
              st_def_fum_rec: parseFloat(
                document.getElementById("st_def_fum_rec").value
              ),
            },
            special_teams_player: {
              st_player_td: parseFloat(
                document.getElementById("st_player_td").value
              ),
              st_player_forced_fum: parseFloat(
                document.getElementById("st_player_forced_fum").value
              ),
              st_player_fum_rec: parseFloat(
                document.getElementById("st_player_fum_rec").value
              ),
            },
            misc: {
              fum_lost: parseFloat(document.getElementById("fum_lost").value),
              fum_rec_td: parseFloat(
                document.getElementById("fum_rec_td").value
              ),
            },
          },
        };

        fetch("/api/config", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(config),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              // Update global leagueConfig
              leagueConfig = config.league;
              // Update draftPick max
              document.getElementById("draftPick").max = leagueConfig.num_teams;
              // Update current round display with new team count
              const currentRoundElement =
                document.getElementById("currentRound");
              const currentText = currentRoundElement.textContent;
              const roundMatch = currentText.match(/Round (\d+), Pick (\d+)/);
              if (roundMatch) {
                const roundNum = parseInt(roundMatch[1]);
                const pickNum = parseInt(roundMatch[2]);
                currentRoundElement.textContent = `Round ${roundNum}, Pick ${pickNum} of ${leagueConfig.num_teams}`;
              }
              // Automatically refresh all tables with new data
              console.log("ðŸ”„ Configuration saved, refreshing data...");
              loadOverallData();
              loadPositionData();
              loadDraftBoardData();

              // Show success message
              alert(
                "Configuration saved successfully! Rankings have been updated."
              );
            } else {
              alert("Error saving configuration");
            }
          })
          .catch((error) => {
            console.error("Error saving config:", error);
            alert("Error saving configuration");
          });
      }

      function resetConfig() {
        if (confirm("Are you sure you want to reset to default settings?")) {
          fetch("/api/config/reset", {
            method: "POST",
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                loadConfig();
                // Refresh all tables with new default data
                console.log("ðŸ”„ Configuration reset, refreshing data...");
                loadOverallData();
                loadPositionData();
                loadDraftBoardData();
                alert(
                  "Configuration reset to defaults! Rankings have been updated."
                );
              } else {
                alert("Error resetting configuration");
              }
            })
            .catch((error) => {
              console.error("Error resetting config:", error);
              alert("Error resetting configuration");
            });
        }
      }

      // Tab event listeners
      document
        .querySelectorAll('button[data-bs-toggle="tab"]')
        .forEach((tab) => {
          tab.addEventListener("shown.bs.tab", (event) => {
            const targetTab = event.target.getAttribute("data-bs-target");
            console.log("ðŸ“‘ Tab shown:", targetTab);

            if (targetTab === "#draft-board") {
              loadDraftBoardData();
            }
          });
        });
    </script>
  </body>
</html>
